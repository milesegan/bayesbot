#!/usr/bin/env ruby
# test a running bayes bot with a given dataset

$: << File.join(File.dirname(__FILE__), "..", "lib")

require 'datafile'
require 'redis'
require 'bayes'

file = DataFile.new(ARGV.first)

r = Redis.new
bcjson = r.get "bc"
bc = Bayes.json_create(bcjson)
correct = 0
file.points.each do |klass, features|
  classified = bc.classify(features).first.first
  puts "#{klass} => #{classified}"
  correct += 1 if classified == klass
end
puts correct.to_f / file.points.size
