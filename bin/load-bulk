#!/usr/bin/env ruby
# bulk-loads a dataset from a text file

$: << File.join(File.dirname(__FILE__), "..", "lib")

require 'redis'
require 'datafile'
require 'bayes'
require 'json'

file = DataFile.new(ARGV.first)

b = Bayes.new
file.points.each do |klass,features|
  b.add_sample(klass, features)
end

r = Redis.new
serial = r.get "serial"
r.set "bc", JSON.dump(b)
r.set "serial", serial.to_i + 1

